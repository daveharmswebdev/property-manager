# Story 8.5.2: Sidebar Styling Update

Status: done

## Story

As a user,
I want the sidebar to use the new deep indigo color scheme,
so that it provides effective contrast while feeling modern rather than harsh.

## Acceptance Criteria

1. **Given** I view the desktop sidebar, **When** it renders, **Then** the background is deep indigo (#1e2340)

2. **And** the logo appears in white (outline version with "upkeep" wordmark)

3. **And** text and icons are appropriately visible with good contrast

4. **Given** I hover over sidebar menu items, **When** interacting with navigation, **Then** hover states use subtle lightening consistent with the new palette

5. **Given** I view the tablet header (hamburger menu mode), **When** it renders, **Then** it also uses the deep indigo background (#1e2340)

6. **Given** I view the mobile header, **When** it renders, **Then** it also uses the deep indigo background (#1e2340)

## Tasks / Subtasks

- [x] Task 1: Update CSS custom property for sidebar background (AC: #1, #5, #6)
  - [x] 1.1 In `styles.scss`, change `--pm-sidebar-bg` from `#1E1E1E` to `#1e2340`
  - [x] 1.2 Update `--pm-sidebar-hover` from `#2D2D2D` to `rgba(255, 255, 255, 0.08)` for subtle lightening

- [x] Task 2: Replace brand header with Upkeep logo (AC: #2)
  - [x] 2.1 In `sidebar-nav.component.html`, replace the brand header content:
    - Remove: `<mat-icon class="brand-icon">home</mat-icon>` and `<span class="brand-text">Property Manager</span>`
    - Add: `<img src="assets/brand/logo-lockup-horizontal-white.svg" alt="Upkeep" class="brand-logo">`
  - [x] 2.2 Update `sidebar-nav.component.scss` `.sidebar-header` styles for proper logo sizing

- [x] Task 3: Update hover/active states for consistency (AC: #4)
  - [x] 3.1 In `sidebar-nav.component.scss`, update hover state to use new subtle lightening
  - [x] 3.2 Verify active state border color still uses `--pm-sidebar-active-border` (#4361ee)
  - [x] 3.3 Ensure footer background uses deep indigo variant (e.g., `rgba(0, 0, 0, 0.15)` instead of `0.2`)

- [x] Task 4: Verify text contrast (AC: #3)
  - [x] 4.1 Confirm `--pm-sidebar-text` (#e2e8f0) has sufficient contrast against #1e2340
  - [x] 4.2 Test with Chrome DevTools accessibility panel or axe DevTools

- [x] Task 5: Update headers (tablet/mobile) for consistency (AC: #5, #6)
  - [x] 5.1 Verify tablet-header and mobile-header in `shell.component.scss` inherit correct `--pm-sidebar-bg`
  - [x] 5.2 Update header title text from "Property Manager" to "Upkeep" in `shell.component.html`

- [x] Task 6: Visual verification (AC: #1-6)
  - [x] 6.1 Verify sidebar renders with deep indigo background
  - [x] 6.2 Verify logo displays correctly (white outline with wordmark)
  - [x] 6.3 Verify hover states are subtle but visible
  - [x] 6.4 Test on desktop, tablet, and mobile breakpoints
  - [x] 6.5 Run existing tests: `npm test`

## Dev Notes

### Critical Architecture Constraints

- **Framework:** Angular 20 with Angular Material 20.x [Source: architecture.md]
- **Styling:** SCSS with CSS custom properties for theming [Source: styles.scss]
- **Component Structure:** Shell component contains sidebar-nav as child component [Source: shell/]
- **Testing:** Vitest for unit/component tests [Source: architecture.md]

### Current State Analysis

**File:** `frontend/src/styles.scss` (134 lines)

Current sidebar CSS variables:
```scss
--pm-sidebar-bg: #1E1E1E;        // Near-black (to change to #1e2340)
--pm-sidebar-text: #E0E0E0;      // Light gray (already updated to #e2e8f0)
--pm-sidebar-hover: #2D2D2D;     // Slightly lighter black (needs update)
--pm-sidebar-active-bg: rgba(67, 97, 238, 0.15);  // Blue tint (already correct)
--pm-sidebar-active-border: #4361ee;              // Blue (already correct)
```

**File:** `frontend/src/app/core/components/sidebar-nav/sidebar-nav.component.html`

Current brand header:
```html
<div class="sidebar-header">
  <mat-icon class="brand-icon">home</mat-icon>
  <span class="brand-text">Property Manager</span>
</div>
```

Needs to become:
```html
<div class="sidebar-header">
  <img src="assets/brand/logo-lockup-horizontal-white.svg" alt="Upkeep" class="brand-logo">
</div>
```

**File:** `frontend/src/app/core/components/sidebar-nav/sidebar-nav.component.scss`

Current `.sidebar-header` styling:
- Uses flex layout with gap: 12px
- Brand icon is 28px
- Brand text is 18px font-weight: 600

**File:** `frontend/src/app/core/components/shell/shell.component.html`

Current header title (lines 29, 53):
- `<span class="header-title">Property Manager</span>`
- Needs update to "Upkeep"

### Color Palette Reference

| Element | Current | Target | Notes |
|---------|---------|--------|-------|
| Sidebar BG | `#1E1E1E` | `#1e2340` | Deep indigo (less harsh) |
| Sidebar Text | `#E0E0E0` | `#e2e8f0` | Slight adjustment |
| Hover State | `#2D2D2D` | `rgba(255,255,255,0.08)` | Subtle lightening |
| Active BG | `rgba(67,97,238,0.15)` | No change | Already blue tint |
| Active Border | `#4361ee` | No change | Already Upkeep blue |

[Source: ux-design-refresh-2026.md Section 2.6]

### Logo Assets Available

Located in `frontend/src/assets/brand/`:
- `logo-lockup-horizontal-white.svg` - **Use this** (white logo + "upkeep" wordmark)
- `logo-outline-white.svg` - Icon only (for collapsed state if needed)
- `logo-icon-only-white.svg` - Compact icon only

[Source: ux-design-refresh-2026.md Section 4.2]

### Previous Story Intelligence (8.5.1)

**Key learnings from theme migration:**
- Used `ng generate @angular/material:m3-theme` schematic (note: kebab-case args)
- Generated palette in `src/styles/_theme-colors.scss`
- Inter font already added to index.html
- Background gradient already applied to content area
- All 928 tests passing after theme update

**Files created/modified in 8.5.1:**
- `frontend/src/styles/_theme-colors.scss` (NEW)
- `frontend/src/styles.scss` - Theme configuration
- `frontend/src/index.html` - Inter font
- `frontend/src/app/core/components/shell/shell.component.scss` - Background gradient

[Source: 8.5-1-angular-material-theme-migration.md]

### Git Intelligence

Recent commit (4ad9239) for 8.5.1:
- Updated styles.scss with new M3 theme
- Added `_theme-colors.scss`
- Modified shell.component.scss (added gradient)

### WCAG Contrast Verification

Target contrast for sidebar:
- Text (#e2e8f0) on background (#1e2340)
- Calculated ratio: ~10.5:1 (WCAG AAA compliant)
- Active text (#4361ee) on active bg (rgba(67,97,238,0.15) on #1e2340)
- Needs visual verification

### Project Structure Notes

**Files to modify:**
```
frontend/
├── src/
│   ├── styles.scss                              # CSS variables update
│   └── app/
│       └── core/
│           └── components/
│               ├── shell/
│               │   ├── shell.component.html     # Header title update
│               │   └── shell.component.scss     # Inherits variables (verify)
│               └── sidebar-nav/
│                   ├── sidebar-nav.component.html   # Logo replacement
│                   └── sidebar-nav.component.scss   # Logo/header styling
```

**Files NOT touched in this story:**
- Logo SVG files (already exist in assets/brand/)
- Theme color palette (done in 8.5.1)
- Favicon (story 8.5.3)
- Individual page components

### Testing Requirements

- **Visual verification:**
  - Desktop sidebar renders with deep indigo
  - Logo displays correctly
  - Hover states work
  - Active state highlights work

- **Responsive testing:**
  - Desktop (1024px+): Full sidebar with logo
  - Tablet (768-1023px): Header with hamburger menu
  - Mobile (<768px): Header with "Upkeep" title

- **Run existing tests:** `npm test` should pass (no functional changes)

### References

- [Source: ux-design-refresh-2026.md#5-ui-refinements] - Sidebar changes specification
- [Source: ux-design-refresh-2026.md#6-implementation-guide] - Step 4: Update sidebar component
- [Source: epic-8.5-ux-design-refresh.md#story-852] - Story acceptance criteria
- [Source: 8.5-1-angular-material-theme-migration.md] - Previous story learnings
- [Source: styles.scss] - Current CSS variables
- [Source: sidebar-nav.component.scss] - Current sidebar styling

### Out of Scope

- Favicon implementation (story 8.5.3)
- Receipt lightbox fix (story 8.5.4)
- Component-by-component color audit (story 8.5.5)
- Dark mode support (not in current scope)

### Definition of Done

- [x] Sidebar background is `#1e2340` (deep indigo)
- [x] Upkeep logo displays in sidebar header
- [x] Header titles updated to "Upkeep"
- [x] Hover states use subtle lightening
- [x] All text has WCAG AA contrast
- [x] Visual verification on desktop, tablet, mobile
- [x] Existing tests pass (`npm test`)
- [x] No console errors

## Dev Agent Record

### Agent Model Used

Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References

- Visual verification screenshots saved to `.playwright-mcp/` folder

### Completion Notes List

- Updated CSS custom properties for sidebar theming in `styles.scss`:
  - `--pm-sidebar-bg`: `#1E1E1E` → `#1e2340` (deep indigo)
  - `--pm-sidebar-text`: `#E0E0E0` → `#e2e8f0`
  - `--pm-sidebar-hover`: `#2D2D2D` → `rgba(255, 255, 255, 0.08)`
- Replaced brand header with Upkeep logo SVG in sidebar-nav component
- Updated sidebar-header SCSS for proper logo sizing (height: 32px, auto width)
- Changed footer background opacity from 0.2 to 0.15 for consistency
- Updated header title text from "Property Manager" to "Upkeep" in shell component (both tablet and mobile headers)
- Added src/assets to angular.json assets configuration to serve brand assets
- Visual verification completed on desktop (1280px), tablet (800px), and mobile (375px) breakpoints
- All 928 unit tests passing
- No console errors

### File List

- `frontend/src/styles.scss` - Updated sidebar CSS variables
- `frontend/src/app/core/components/sidebar-nav/sidebar-nav.component.html` - Replaced brand header with logo
- `frontend/src/app/core/components/sidebar-nav/sidebar-nav.component.scss` - Updated header styling, footer opacity
- `frontend/src/app/core/components/shell/shell.component.html` - Updated header titles to "Upkeep"
- `frontend/angular.json` - Added src/assets to assets configuration

## Change Log

| Date | Change | Author |
|------|--------|--------|
| 2026-01-18 | Story implementation complete - sidebar styling update with deep indigo theme, Upkeep logo, and responsive headers | Claude Opus 4.5 |
