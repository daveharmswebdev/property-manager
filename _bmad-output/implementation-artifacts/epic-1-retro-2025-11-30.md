# Epic 1 Retrospective: Foundation

**Date:** 2025-11-30
**Facilitator:** Bob (Scrum Master)
**Participants:** Dave (Project Lead), Alice (Product Owner), Charlie (Senior Dev), Dana (QA Engineer), Elena (Junior Dev)

---

## Epic Summary

| Metric | Value |
|--------|-------|
| Epic | 1 - Foundation |
| Stories Completed | 8/8 (100%) |
| Backend Tests | 49 passing |
| Frontend Tests | 40 passing |
| Production Incidents | 0 |

**Business Outcome:** Users can register, verify email, login, logout, reset password, and access a protected dashboard with responsive navigation.

---

## What Went Well

### Delivery
- **100% story completion** - All 8 stories delivered
- **Complete auth flow** - Registration, email verification, login, logout, password reset
- **Responsive application shell** - Desktop sidebar, tablet collapsible, mobile bottom nav

### Technical Excellence
- **Clean Architecture maintained** - Domain layer has zero external dependencies
- **Multi-tenant database design** - AccountId filtering working correctly
- **Smart technology reuse** - ASP.NET Core Identity for auth instead of custom implementation
- **Good testing coverage** - 89 total tests (49 backend, 40 frontend)
- **Testcontainers adoption** - Integration tests against real PostgreSQL

### Infrastructure
- **Render deployment working** - API and frontend deployed
- **SendGrid integration** - Transactional emails functional
- **Domain names acquired** - upkeep-io.dev and upkeep-io.com
- **Email sender configured** - Using noreply@upkeep-io.dev
- **CI/CD pipeline established** - GitHub Actions for build/test/deploy

### Key Technical Decisions
- Story 1.3: Created `ApplicationUser` extending `IdentityUser<Guid>` instead of custom user management
- Story 1.6: Used Identity's built-in password reset tokens instead of custom entity
- Story 1.7: Leveraged Angular CDK BreakpointObserver for responsive design

---

## What Didn't Go Well

### Issues Discovered
1. **GitHub Actions CD syntax error** - Secrets cannot be used directly in `if` conditions
   - **Status:** Fixed during retrospective
   - **Root cause:** GitHub Actions limitation not caught in review

2. **Email verification token expiry UX gap** - No resend verification email option
   - **Status:** GitHub Issue #2 created
   - **Impact:** Users with expired tokens hit dead-end, may encounter "email already exists" error

3. **No branch protection on master** - Direct commits to master allowed
   - **Status:** Configuration needed in GitHub
   - **Risk:** Unreviewed code could reach production

4. **Custom domain not configured** - Using Render default subdomain
   - **Status:** Priority action item
   - **Impact:** Less professional, affects CORS and email links

### Normal First-Deployment Friction
- Database connection configuration (SSL, connection string format)
- Render-specific environment variable setup
- Version availability (.NET 10, Angular 21 not released when spec'd)

---

## Lessons Learned

### Process
1. **Set up branch protection on day one** - Don't wait until after the first epic
2. **Validate GitHub Actions workflows locally** - Use `act` or similar tooling
3. **Consider error recovery paths** - Every error state needs a way forward for users

### Technical
1. **Secrets in GitHub Actions** - Map to env vars at job level, check `env.VAR` in conditionals
2. **ASP.NET Core Identity** - Powerful out-of-box; prefer built-in over custom for auth flows
3. **Testcontainers** - Worth the setup cost for reliable integration tests
4. **Render connection strings** - Use internal hostnames, SSL Mode=Require

### Architecture
1. **Clean Architecture pays off** - Clear boundaries made each story easier to implement
2. **Multi-tenant from the start** - AccountId filtering baked in early prevents retrofitting
3. **Feature-based Angular structure** - Easy to navigate and extend

---

## Action Items

| Priority | Action | Owner | Status |
|----------|--------|-------|--------|
| **P0** | Configure custom domain on Render (upkeep-io.dev) | Dave | TODO |
| P1 | Set up branch protection on master | Dave | TODO |
| P2 | Implement email verification resend flow | Backlog | GitHub Issue #2 |
| ✅ | Fix GitHub Actions CD workflow syntax | Claude | Done |
| ✅ | Configure email sender (noreply@upkeep-io.dev) | Dave | Done |

---

## Epic 2 Preparation

### Dependencies from Epic 1 (All Met)
- [x] Authentication system (JWT, refresh tokens)
- [x] Multi-tenant database with AccountId isolation
- [x] Application shell with navigation
- [x] Property entity and database table
- [x] Placeholder routes for `/properties`

### Commitments for Epic 2
1. **CI/CD Smoothness** - Document deployment learnings, monitor for issues
2. **Migration Visibility** - Add logging or health endpoint for migration status
3. **Testing Pyramid** - Add Playwright E2E tests for property creation flow
4. **Branch Protection** - Must be configured before starting Epic 2

### Risk Areas to Watch
- Property form validation UX
- Dashboard stats aggregation performance
- Image handling if property photos added later

---

## Retrospective Health Check

| Question | Rating |
|----------|--------|
| Did we deliver what we committed to? | ✅ Yes (100%) |
| Is the codebase healthy? | ✅ Yes |
| Is the team healthy? | ✅ Yes |
| Are we ready for Epic 2? | ✅ Yes (after P0/P1 actions) |

---

## Quotes & Observations

> "The fact that it wasn't 'the worst deployment experience' is actually a good sign." - Dana

> "Having actual domain names - this isn't a toy project anymore." - Alice

> "The patterns are established now. Less discovery, more execution." - Elena

---

**Next Epic:** Epic 2 - Property Management (5 stories)
**Target:** Users can add, view, edit, and delete their 14 rental properties

---

*Generated by BMad Method Retrospective Workflow*
